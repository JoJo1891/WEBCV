{# templates/base.html.twig #}
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}Welcome!{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style type="text/css">
    	.fixbottom{
    		position: absolute;
    		bottom: 0;
 			height: 100px;
    	}
    	.height100{
 			height: 100%!important;
    	}
    </style>
    {% block stylesheets %}
    {% endblock %}
  </head>
  <body>
  	<nav>
    	<div class="nav-wrapper grey darken-4">
		    <a href="{{ path('app_home') }}" class="brand-logo">Web CV</a>
		    <ul id="nav-mobile" class="right hide-on-med-and-down">
		    	{% if app.user %}
			        <li><a class="hoverable" href="{{ path('app_about') }}">A Propos</a></li>
			        <li><a class="hoverable" href="{{ path('app_contact') }}">Contact</a></li>
			        <li><a class="hoverable" href="{{ path('cv_index')}}">Mes CV</a></li>
			        <li><a class="hoverable" href="{{ path('app_logout') }}">Logout</a></li>
		        {% else %}
			        <li><a class="hoverable" href="{{ path('app_about') }}">A Propos</a></li>
			        <li><a class="hoverable" href="{{ path('app_contact') }}">Contact</a></li>
			        <li><a class="hoverable" href="{{ path('app_login') }}">Login</a></li>
        		{% endif %}
		    </ul>
    	</div>
  	</nav>
    
    {% block body %}{% endblock %} 
    

    <nav class="fixbottom hide-on-large-only">
    	<div class="nav-wrapper grey darken-4">
		    <ul class="row center-align">
		    	{% if app.user %}
			        <li class="col s2 offset-s1 height100"><a class="flow-text" href="{{ path('app_home') }}">Accueil</a></li>
			        <li class="col s2 height100"><a class="flow-text" href="{{ path('app_about') }}">A Propos</a></li>
			        <li class="col s2 height100"><a class="flow-text" href="{{ path('app_contact') }}">Contact</a></li>
			        {% if is_granted('ROLE_ADMIN') %}
			        <li class="col s2 height100"><a class="flow-text" href="{{ path('app_admin_home')}}">Admin</a></li>
			        {% else %}
			        <li class="col s2 height100"><a class="flow-text" href="{{ path('cv_index')}}">Mes CV</a></li>
					{% endif %}
			        <li class="col s2 height100"><a class="flow-text" href="{{ path('app_logout') }}">Logout</a></li>
		        {% else %}
		        	<li class="col s3 height100"><a class="flow-text" href="{{ path('app_home') }}" >Accueil</a></li>

			        <li class="col s3 height100"><a class="flow-text" href="{{ path('app_about') }}">A Propos</a></li>

			        <li class="col s3 height100"><a class="flow-text" href="{{ path('app_contact') }}">Contact</a></li>

			        <li class="col s3 height100"><a class="flow-text" href="{{ path('app_login') }}">Login</a></li>
        		{% endif %}
		    </ul>
    	</div>
  	</nav>
    
    {% block javascripts %}
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
            <script src="{{ asset("build/app.js") }}"></script>
            <!-- Compiled and minified JavaScript -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>  
            <script type="text/javascript">
            	$(document).ready(function(){
				    $('.sidenav').sidenav();
				    $(".dropdown-trigger").dropdown();
				});
            </script> 
            <script type="text/javascript">
            	$(".filtreUser").click(function(){
                var filt = $(this).attr('val');
                alert(filt);
                   	
                $.ajax({
                   url : filt,
                   type : 'POST',
                   success: function(data) {

                   		alert(data);
                   		console.log(data);
                   		
                		$("#donneeFiltre").remove();
                		alert(data);
				        onSuccess(data);   
				    },

                   error : function(resultat, statut, erreur){
                   	alert("oups Ã§a marche plus");
                   }

                });
                function onSuccess(data) {
				  let html = "";
				    html += 
				    `{% for user in "${data}"%}
						    <tr>
						        <td>{{ user.id }}</td>
						        <td>{{ user.name }}</td>
						        <td>{{ user.email }}</td>
						        <td>{{ user.roles ? user.roles|json_encode : '' }}</td>
						        <td>
						            <a href="{{ path('user_show', {'id': user.id}) }}">show</a>
						            <a href="{{ path('user_edit', {'id': user.id}) }}">edit</a>
						        </td>
						    </tr>
						{% else %}
						{% endfor %}`;
				  
				  $('#donneeFiltre').html(html);
				}
               
            });
        </script>
	{% endblock %}
  </body>
</html>